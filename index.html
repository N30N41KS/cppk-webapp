<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –†–∞–ø–æ—Ä—Ç</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    :root {
      --primary-color: #005AAB;
      --bg-color: var(--tg-theme-bg-color, #ffffff);
      --text-color: var(--tg-theme-text-color, #000000);
      --input-bg: var(--tg-theme-secondary-bg-color, #f0f2f5);
      --hint-color: var(--tg-theme-hint-color, #e0e0e9);
      --button-text: var(--tg-theme-button-text-color, #ffffff);
      --shadow: rgba(0,0,0,0.1);
    }

    * {
      transition: border-color 0.3s ease, background-color 0.3s ease;
    }

    html, body {
      background-color: var(--bg-color);
      color: var(--text-color);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      margin: 0; padding: 0; box-sizing: border-box; height: 100%; overflow-x: hidden;
    }

    body { padding: 20px 15px; }

    h2 {
      text-align: center;
      margin-top: 0;
      margin-bottom: 20px;
      font-size: 22px;
      color: var(--text-color);
      font-weight: 700;
    }

    .tabs {
      display: flex;
      position: relative;
      background: var(--input-bg);
      border-radius: 12px;
      margin-bottom: 20px;
      padding: 4px;
    }

    .tab {
      flex: 1;
      text-align: center;
      padding: 10px;
      font-weight: 600;
      font-size: 14px;
      color: var(--hint-color);
      cursor: pointer;
      z-index: 2;
      transition: color 0.3s;
    }

    .tab.active { color: var(--text-color); }

    .tab-slider {
      position: absolute;
      top: 4px;
      bottom: 4px;
      left: 4px;
      width: calc(50% - 4px);
      background: var(--bg-color);
      border-radius: 8px;
      z-index: 1;
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 2px 8px var(--shadow);
    }

    .tabs.metro-active .tab-slider {
      transform: translateX(100%);
    }
    .form-group {
      position: relative;
      margin-bottom: 18px;
    }

    label {
      display: block;
      font-weight: 500;
      margin-bottom: 8px;
      color: var(--hint-color);
      font-size: 14px;
      margin-left: 4px;
    }

    input, textarea {
      width: 100%;
      box-sizing: border-box;
      padding: 14px;
      border: 2px solid transparent;
      border-radius: 12px;
      background: var(--input-bg);
      color: var(--text-color);
      font-size: 16px;
      outline: none;
    }

    input::placeholder,
    textarea::placeholder {
      color: var(--hint-color);
    }

    input:focus,
    textarea:focus {
      border-color: var(--primary-color);
    }

    button {
      position: relative;
      width: 100%;
      height: 54px;
      background-color: var(--primary-color);
      color: var(--button-text);
      border: none;
      border-radius: 12px;
      font-size: 17px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 10px;
      overflow: visible;
    }

    button:active:not(.train-depart) {
      transform: scale(0.98);
    }

    .train-depart {
      animation: btnFade 0.15s forwards,
                 trainDrive 3.5s 0.2s cubic-bezier(0.4, 0, 0.2, 1) forwards !important;
      background-color: transparent !important;
      box-shadow: none !important;
      pointer-events: none;
    }

    @keyframes btnFade {
      to { background-color: transparent; }
    }

    .train-depart .btn-text {
      display: none;
    }

    .train-depart .train-wrapper {
      display: flex;
    }

    .train-wrapper {
      display: none;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      height: 26px;
      gap: 4px;
      align-items: center;
    }

    .train-car {
      background-color: #4b5563;
      width: 40px;
      height: 100%;
      position: relative;
      border-radius: 3px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.3);
    }

    .train-car::after {
      content: '';
      position: absolute;
      top: 6px;
      left: 4px;
      right: 4px;
      height: 8px;
      background-color: var(--primary-color);
      border-radius: 2px;
      opacity: 0.9;
    }

    .train-car::before {
      content: '';
      position: absolute;
      top: 5px;
      bottom: 2px;
      left: 50%;
      width: 4px;
      transform: translateX(-50%);
      background-color: #1f2937;
      border-radius: 1px;
      z-index: 2;
    }

    .train-car.head {
      border-radius: 3px 14px 14px 3px;
      width: 50px;
    }

    .train-car.head .headlight {
      position: absolute;
      right: 2px;
      bottom: 4px;
      width: 6px;
      height: 6px;
      background-color: #FFD702;
      border-radius: 50%;
      box-shadow: 4px 0 10px #FFD702;
    }

    .train-car.tail {
      border-radius: 14px 3px 3px 14px;
      width: 50px;
    }

    .train-car.tail .taillight {
      position: absolute;
      left: 2px;
      bottom: 4px;
      width: 6px;
      height: 6px;
      background-color: #EF161E;
      border-radius: 50%;
    }

    @keyframes trainDrive {
      0%   { transform: translate(-50%, -50%); }
      10%  { transform: translate(-55%, -50%); }
      100% { transform: translate(200vw, -50%); }
    }

    .custom-dropdown {
      position: absolute;
      top: calc(100% + 5px);
      left: 0;
      right: 0;
      background-color: var(--bg-color);
      border: 1px solid var(--input-bg);
      border-radius: 4px;
      max-height: 220px;
      overflow-y: auto;
      z-index: 1000;
      display: none;
      box-shadow: 0 8px 20px var(--shadow);
    }

    .custom-dropdown.active {
      display: block;
    }

    .dropdown-item {
      padding: 12px 14px;
      display: flex;
      align-items: center;
      cursor: pointer;
      border-bottom: 1px solid var(--input-bg);
    }

    .dropdown-item:last-child {
      border-bottom: none;
    }

    .dropdown-item:hover {
      background-color: var(--input-bg);
    }

    .icon-box {
      width: 24px;
      height: 24px;
      margin-right: 12px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .icon-box img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .station-name {
      font-size: 15px;
      font-weight: 500;
      color: var(--text-color);
    }
  </style>
</head>
<body>

<h2>üö® –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏</h2>

<div class="tabs" id="tabs-container">
  <div class="tab-slider"></div>

  <div class="tab active" id="tab-mcd" onclick="switchCategory('mcd')">
    üöÜ –ú–¶–î (–¶–ü–ü–ö)
  </div>

  <div class="tab" id="tab-metro" onclick="switchCategory('metro')">
    üöá –ú–µ—Ç—Ä–æ (–î–µ–ø—Ç—Ä–∞–Ω—Å)
  </div>
</div>

<div class="form-group">
  <label>–ì–¥–µ –ø—Ä–æ–∏–∑–æ—à–µ–ª –∏–Ω—Ü–∏–¥–µ–Ω—Ç?</label>
  <input type="text" id="station-search" placeholder="üîç –ü–æ–∏—Å–∫ —Å—Ç–∞–Ω—Ü–∏–∏..." autocomplete="off">
  <div id="custom-stations-list" class="custom-dropdown"></div>
</div>

<div class="form-group">
  <label>–î–µ—Ç–∞–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã</label>
  <textarea id="description" rows="4" placeholder="–ù–∞–ø—Ä: –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç—å —Ç—É—Ä–Ω–∏–∫–µ—Ç–∞..."></textarea>
</div>

<button id="submit-btn">
  <span class="btn-text">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∏—Å–ø–µ—Ç—á–µ—Ä—É</span>

  <span class="train-wrapper">
    <div class="train-car tail">
      <div class="taillight"></div>
    </div>

    <div class="train-car passenger"></div>
    <div class="train-car passenger"></div>

    <div class="train-car head">
      <div class="headlight"></div>
    </div>
  </span>
</button>
<script>
  const tg = window.Telegram.WebApp;
  tg.expand();

  const lineColors = {
    "1": "#EF161E", "2": "#2D82BC", "3": "#0078BF", "4": "#00BFFF",
    "5": "#8D552D", "6": "#ED9121", "7": "#800080", "8": "#FFD702",
    "8A": "#FFD702", "9": "#999999", "10": "#22B14C", "11": "#A1B3AD",
    "12": "#9999FF", "14": "#F6F032", "15": "#43404A",
    "D1": "#9E5B0C", "D2": "#E74280", "D3": "#9E5B0C", "D4": "#40826B"
  };

  const data = {
    "1": ["–ë—É–ª—å–≤–∞—Ä –†–æ–∫–æ—Å—Å–æ–≤—Å–∫–æ–≥–æ", "–ß–µ—Ä–∫–∏–∑–æ–≤—Å–∫–∞—è", "–ü—Ä–µ–æ–±—Ä–∞–∂–µ–Ω—Å–∫–∞—è –ø–ª–æ—â–∞–¥—å", "–°–æ–∫–æ–ª—å–Ω–∏–∫–∏", "–ö—Ä–∞—Å–Ω–æ—Å–µ–ª—å—Å–∫–∞—è", "–ö–æ–º—Å–æ–º–æ–ª—å—Å–∫–∞—è", "–ö—Ä–∞—Å–Ω—ã–µ –≤–æ—Ä–æ—Ç–∞", "–ß–∏—Å—Ç—ã–µ –ø—Ä—É–¥—ã", "–õ—É–±—è–Ω–∫–∞", "–û—Ö–æ—Ç–Ω—ã–π —Ä—è–¥", "–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏–º–µ–Ω–∏ –õ–µ–Ω–∏–Ω–∞", "–ö—Ä–æ–ø–æ—Ç–∫–∏–Ω—Å–∫–∞—è", "–ü–∞—Ä–∫ –∫—É–ª—å—Ç—É—Ä—ã", "–§—Ä—É–Ω–∑–µ–Ω—Å–∫–∞—è", "–°–ø–æ—Ä—Ç–∏–≤–Ω–∞—è", "–í–æ—Ä–æ–±—å—ë–≤—ã –≥–æ—Ä—ã", "–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç", "–ü—Ä–æ—Å–ø–µ–∫—Ç –í–µ—Ä–Ω–∞–¥—Å–∫–æ–≥–æ", "–Æ–≥–æ-–ó–∞–ø–∞–¥–Ω–∞—è", "–¢—Ä–æ–ø–∞—Ä—ë–≤–æ", "–†—É–º—è–Ω—Ü–µ–≤–æ", "–°–∞–ª–∞—Ä—å–µ–≤–æ", "–§–∏–ª–∞—Ç–æ–≤ –ª—É–≥", "–ü—Ä–æ–∫—à–∏–Ω–æ", "–û–ª—å—Ö–æ–≤–∞—è", "–ö–æ–º–º—É–Ω–∞—Ä–∫–∞"],
    "2": ["–•–æ–≤—Ä–∏–Ω–æ", "–ë–µ–ª–æ–º–æ—Ä—Å–∫–∞—è", "–†–µ—á–Ω–æ–π –≤–æ–∫–∑–∞–ª", "–í–æ–¥–Ω—ã–π —Å—Ç–∞–¥–∏–æ–Ω", "–í–æ–π–∫–æ–≤—Å–∫–∞—è", "–°–æ–∫–æ–ª", "–ê—ç—Ä–æ–ø–æ—Ä—Ç", "–î–∏–Ω–∞–º–æ", "–ë–µ–ª–æ—Ä—É—Å—Å–∫–∞—è", "–ú–∞—è–∫–æ–≤—Å–∫–∞—è", "–¢–≤–µ—Ä—Å–∫–∞—è", "–¢–µ–∞—Ç—Ä–∞–ª—å–Ω–∞—è", "–ù–æ–≤–æ–∫—É–∑–Ω–µ—Ü–∫–∞—è", "–ü–∞–≤–µ–ª–µ—Ü–∫–∞—è", "–ê–≤—Ç–æ–∑–∞–≤–æ–¥—Å–∫–∞—è", "–¢–µ—Ö–Ω–æ–ø–∞—Ä–∫", "–ö–æ–ª–æ–º–µ–Ω—Å–∫–∞—è", "–ö–∞—à–∏—Ä—Å–∫–∞—è", "–ö–∞–Ω—Ç–µ–º–∏—Ä–æ–≤—Å–∫–∞—è", "–¶–∞—Ä–∏—Ü—ã–Ω–æ", "–û—Ä–µ—Ö–æ–≤–æ", "–î–æ–º–æ–¥–µ–¥–æ–≤—Å–∫–∞—è", "–ö—Ä–∞—Å–Ω–æ–≥–≤–∞—Ä–¥–µ–π—Å–∫–∞—è", "–ê–ª–º–∞-–ê—Ç–∏–Ω—Å–∫–∞—è"],
    "3": ["–ü—è—Ç–Ω–∏—Ü–∫–æ–µ —à–æ—Å—Å–µ", "–ú–∏—Ç–∏–Ω–æ", "–í–æ–ª–æ–∫–æ–ª–∞–º—Å–∫–∞—è", "–ú—è–∫–∏–Ω–∏–Ω–æ", "–°—Ç—Ä–æ–≥–∏–Ω–æ", "–ö—Ä—ã–ª–∞—Ç—Å–∫–æ–µ", "–ú–æ–ª–æ–¥—ë–∂–Ω–∞—è", "–ö—É–Ω—Ü–µ–≤—Å–∫–∞—è", "–°–ª–∞–≤—è–Ω—Å–∫–∏–π –±—É–ª—å–≤–∞—Ä", "–ü–∞—Ä–∫ –ü–æ–±–µ–¥—ã", "–ö–∏–µ–≤—Å–∫–∞—è", "–°–º–æ–ª–µ–Ω—Å–∫–∞—è", "–ê—Ä–±–∞—Ç—Å–∫–∞—è", "–ü–ª–æ—â–∞–¥—å –†–µ–≤–æ–ª—é—Ü–∏–∏", "–ö—É—Ä—Å–∫–∞—è", "–ë–∞—É–º–∞–Ω—Å–∫–∞—è", "–≠–ª–µ–∫—Ç—Ä–æ–∑–∞–≤–æ–¥—Å–∫–∞—è", "–°–µ–º—ë–Ω–æ–≤—Å–∫–∞—è", "–ü–∞—Ä—Ç–∏–∑–∞–Ω—Å–∫–∞—è", "–ò–∑–º–∞–π–ª–æ–≤—Å–∫–∞—è", "–ü–µ—Ä–≤–æ–º–∞–π—Å–∫–∞—è", "–©—ë–ª–∫–æ–≤—Å–∫–∞—è"],
    "4": ["–ö—É–Ω—Ü–µ–≤—Å–∫–∞—è", "–ü–∏–æ–Ω–µ—Ä—Å–∫–∞—è", "–§–∏–ª—ë–≤—Å–∫–∏–π –ø–∞—Ä–∫", "–ë–∞–≥—Ä–∞—Ç–∏–æ–Ω–æ–≤—Å–∫–∞—è", "–§–∏–ª–∏", "–ö—É—Ç—É–∑–æ–≤—Å–∫–∞—è", "–°—Ç—É–¥–µ–Ω—á–µ—Å–∫–∞—è", "–°–º–æ–ª–µ–Ω—Å–∫–∞—è", "–ê—Ä–±–∞—Ç—Å–∫–∞—è", "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤—Å–∫–∏–π —Å–∞–¥"],
    "5": ["–ö–∏–µ–≤—Å–∫–∞—è", "–ö—Ä–∞—Å–Ω–æ–ø—Ä–µ—Å–Ω–µ–Ω—Å–∫–∞—è", "–ë–µ–ª–æ—Ä—É—Å—Å–∫–∞—è", "–ù–æ–≤–æ—Å–ª–æ–±–æ–¥—Å–∫–∞—è", "–ü—Ä–æ—Å–ø–µ–∫—Ç –ú–∏—Ä–∞", "–ö–æ–º—Å–æ–º–æ–ª—å—Å–∫–∞—è", "–ö—É—Ä—Å–∫–∞—è", "–¢–∞–≥–∞–Ω—Å–∫–∞—è", "–ü–∞–≤–µ–ª–µ—Ü–∫–∞—è", "–î–æ–±—Ä—ã–Ω–∏–Ω—Å–∫–∞—è", "–û–∫—Ç—è–±—Ä—å—Å–∫–∞—è", "–ü–∞—Ä–∫ –∫—É–ª—å—Ç—É—Ä—ã"],
    "6": ["–ù–æ–≤–æ—è—Å–µ–Ω–µ–≤—Å–∫–∞—è", "–Ø—Å–µ–Ω–µ–≤–æ", "–¢—ë–ø–ª—ã–π —Å—Ç–∞–Ω", "–ö–æ–Ω—å–∫–æ–≤–æ", "–ë–µ–ª—è–µ–≤–æ", "–ö–∞–ª—É–∂—Å–∫–∞—è", "–ù–æ–≤—ã–µ –ß–µ—Ä—ë–º—É—à–∫–∏", "–ü—Ä–æ—Ñ—Å–æ—é–∑–Ω–∞—è", "–ê–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∞—è", "–õ–µ–Ω–∏–Ω—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç", "–®–∞–±–æ–ª–æ–≤—Å–∫–∞—è", "–û–∫—Ç—è–±—Ä—å—Å–∫–∞—è", "–¢—Ä–µ—Ç—å—è–∫–æ–≤—Å–∫–∞—è"],
    "7": ["–ö–æ—Ç–µ–ª—å–Ω–∏–∫–∏", "–ñ—É–ª–µ–±–∏–Ω–æ", "–õ–µ—Ä–º–æ–Ω—Ç–æ–≤—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç", "–í—ã—Ö–∏–Ω–æ", "–†—è–∑–∞–Ω—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç", "–ö—É–∑—å–º–∏–Ω–∫–∏", "–¢–µ–∫—Å—Ç–∏–ª—å—â–∏–∫–∏", "–í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç", "–ü—Ä–æ–ª–µ—Ç–∞—Ä—Å–∫–∞—è", "–¢–∞–≥–∞–Ω—Å–∫–∞—è", "–ö–∏—Ç–∞–π-–≥–æ—Ä–æ–¥", "–ö—É–∑–Ω–µ—Ü–∫–∏–π –º–æ—Å—Ç", "–ü—É—à–∫–∏–Ω—Å–∫–∞—è", "–ë–∞—Ä—Ä–∏–∫–∞–¥–Ω–∞—è", "–£–ª–∏—Ü–∞ 1905 –≥–æ–¥–∞", "–ë–µ–≥–æ–≤–∞—è", "–ü–æ–ª–µ–∂–∞–µ–≤—Å–∫–∞—è", "–û–∫—Ç—è–±—Ä—å—Å–∫–æ–µ –ø–æ–ª–µ", "–©—É–∫–∏–Ω—Å–∫–∞—è", "–°–ø–∞—Ä—Ç–∞–∫", "–¢—É—à–∏–Ω—Å–∫–∞—è", "–°—Ö–æ–¥–Ω–µ–Ω—Å–∫–∞—è", "–ü–ª–∞–Ω–µ—Ä–Ω–∞—è"],
    "8": ["–°–∞–ª–∞—Ä—å–µ–≤–æ", "–§–∏–ª–∞—Ç–æ–≤ –ª—É–≥", "–ü—Ä–æ–∫—à–∏–Ω–æ", "–û–ª—å—Ö–æ–≤–∞—è", "–ö–æ–º–º—É–Ω–∞—Ä–∫–∞"],
    "8A": ["–†–∞—Å—Å–∫–∞–∑–æ–≤–∫–∞", "–ù–æ–≤–æ–ø–µ—Ä–µ–¥–µ–ª–∫–∏–Ω–æ", "–ë–æ—Ä–æ–≤—Å–∫–æ–µ —à–æ—Å—Å–µ", "–°–æ–ª–Ω—Ü–µ–≤–æ", "–ì–æ–≤–æ—Ä–æ–≤–æ", "–û–∑—ë—Ä–Ω–∞—è", "–ú–∏—á—É—Ä–∏–Ω—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç", "–†–∞–º–µ–Ω–∫–∏", "–õ–æ–º–æ–Ω–æ—Å–æ–≤—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç", "–ú–∏–Ω—Å–∫–∞—è", "–ü–∞—Ä–∫ –ü–æ–±–µ–¥—ã"],
    "9": ["–ê–ª—Ç—É—Ñ—å–µ–≤–æ", "–ë–∏–±–∏—Ä–µ–≤–æ", "–û—Ç—Ä–∞–¥–Ω–æ–µ", "–í–ª–∞–¥—ã–∫–∏–Ω–æ", "–ü–µ—Ç—Ä–æ–≤—Å–∫–æ-–†–∞–∑—É–º–æ–≤—Å–∫–∞—è", "–¢–∏–º–∏—Ä—è–∑–µ–≤—Å–∫–∞—è", "–î–º–∏—Ç—Ä–æ–≤—Å–∫–∞—è", "–°–∞–≤—ë–ª–æ–≤—Å–∫–∞—è", "–ú–µ–Ω–¥–µ–ª–µ–µ–≤—Å–∫–∞—è", "–¶–≤–µ—Ç–Ω–æ–π –±—É–ª—å–≤–∞—Ä", "–ß–µ—Ö–æ–≤—Å–∫–∞—è", "–ë–æ—Ä–æ–≤–∏—Ü–∫–∞—è", "–ü–æ–ª—è–Ω–∫–∞", "–°–µ—Ä–ø—É—Ö–æ–≤—Å–∫–∞—è", "–¢—É–ª—å—Å–∫–∞—è", "–ù–∞–≥–∞—Ç–∏–Ω—Å–∫–∞—è", "–ù–∞–≥–æ—Ä–Ω–∞—è", "–ù–∞—Ö–∏–º–æ–≤—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç", "–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å—Å–∫–∞—è", "–ß–µ—Ä—Ç–∞–Ω–æ–≤—Å–∫–∞—è", "–Æ–∂–Ω–∞—è", "–ü—Ä–∞–∂—Å–∫–∞—è", "–£–ª–∏—Ü–∞ –ê–∫–∞–¥–µ–º–∏–∫–∞ –Ø–Ω–≥–µ–ª—è", "–ê–Ω–Ω–∏–Ω–æ", "–ë—É–ª—å–≤–∞—Ä –î–º–∏—Ç—Ä–∏—è –î–æ–Ω—Å–∫–æ–≥–æ"],
    "10": ["–ú–µ–¥–≤–µ–¥–∫–æ–≤–æ", "–ë–∞–±—É—à–∫–∏–Ω—Å–∫–∞—è", "–°–≤–∏–±–ª–æ–≤–æ", "–ë–æ—Ç–∞–Ω–∏—á–µ—Å–∫–∏–π —Å–∞–¥", "–í–î–ù–•", "–ê–ª–µ–∫—Å–µ–µ–≤—Å–∫–∞—è", "–†–∏–∂—Å–∫–∞—è", "–ü—Ä–æ—Å–ø–µ–∫—Ç –ú–∏—Ä–∞", "–°—É—Ö–∞—Ä–µ–≤—Å–∫–∞—è", "–¢—É—Ä–≥–µ–Ω–µ–≤—Å–∫–∞—è", "–ß–∫–∞–ª–æ–≤—Å–∫–∞—è", "–†–∏–º—Å–∫–∞—è", "–ö—Ä–µ—Å—Ç—å—è–Ω—Å–∫–∞—è –∑–∞—Å—Ç–∞–≤–∞", "–î—É–±—Ä–æ–≤–∫–∞", "–ö–æ–∂—É—Ö–æ–≤—Å–∫–∞—è", "–ü–µ—á–∞—Ç–Ω–∏–∫–∏", "–í–æ–ª–∂—Å–∫–∞—è", "–õ—é–±–ª–∏–Ω–æ", "–ë—Ä–∞—Ç–∏—Å–ª–∞–≤—Å–∫–∞—è", "–ú–∞—Ä—å–∏–Ω–æ", "–ë–æ—Ä–∏—Å–æ–≤–æ", "–®–∏–ø–∏–ª–æ–≤—Å–∫–∞—è", "–ó—è–±–ª–∏–∫–æ–≤–æ"],
    "11": ["–ö—É–Ω—Ü–µ–≤—Å–∫–∞—è", "–ú–æ–∂–∞–π—Å–∫–∞—è", "–ê–º–∏–Ω—å–µ–≤—Å–∫–∞—è", "–î–∞–≤—ã–¥–∫–æ–≤–æ", "–ü–ª—é—â–µ–≤–æ", "–¢–µ—Ä–µ—Ö–æ–≤–æ", "–ù–∞—Ä–æ–¥–Ω–æ–µ –û–ø–æ–ª—á–µ–Ω–∏–µ", "–•–æ—Ä–æ—à—ë–≤—Å–∫–∞—è", "–¶–°–ö–ê", "–ü–µ—Ç—Ä–æ–≤—Å–∫–∏–π –ø–∞—Ä–∫", "–°–∞–≤—ë–ª–æ–≤—Å–∫–∞—è", "–†–∏–∂—Å–∫–∞—è", "–°–æ–∫–æ–ª—å–Ω–∏–∫–∏", "–≠–ª–µ–∫—Ç—Ä–æ–∑–∞–≤–æ–¥—Å–∫–∞—è", "–õ–µ—Ñ–æ—Ä—Ç–æ–≤–æ", "–ê–≤–∏–∞–º–æ—Ç–æ—Ä–Ω–∞—è", "–ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∞—è", "–¢–µ–∫—Å—Ç–∏–ª—å—â–∏–∫–∏", "–ü–µ—á–∞—Ç–Ω–∏–∫–∏", "–ö–ª–µ–Ω–æ–≤—ã–π –±—É–ª—å–≤–∞—Ä", "–ö–∞—à–∏—Ä—Å–∫–∞—è", "–í–∞—Ä—à–∞–≤—Å–∫–∞—è", "–ö–∞—Ö–æ–≤—Å–∫–∞—è"],
    "12": ["–°–∞–≤—ë–ª–æ–≤—Å–∫–∞—è", "–ü–µ—Ç—Ä–æ–≤—Å–∫–∏–π –ø–∞—Ä–∫", "–¶–°–ö–ê", "–•–æ—Ä–æ—à—ë–≤—Å–∫–∞—è", "–®–µ–ª–µ–ø–∏—Ö–∞", "–î–µ–ª–æ–≤–æ–π —Ü–µ–Ω—Ç—Ä"],
    "14": ["–î–µ–ª–æ–≤–æ–π —Ü–µ–Ω—Ç—Ä", "–®–µ–ª–µ–ø–∏—Ö–∞", "–•–æ—Ä–æ—à—ë–≤—Å–∫–∞—è", "–¶–°–ö–ê", "–ü–µ—Ç—Ä–æ–≤—Å–∫–∏–π –ø–∞—Ä–∫", "–°–∞–≤—ë–ª–æ–≤—Å–∫–∞—è", "–†–∏–∂—Å–∫–∞—è", "–°–æ–∫–æ–ª—å–Ω–∏–∫–∏", "–≠–ª–µ–∫—Ç—Ä–æ–∑–∞–≤–æ–¥—Å–∫–∞—è", "–õ–µ—Ñ–æ—Ä—Ç–æ–≤–æ", "–ê–≤–∏–∞–º–æ—Ç–æ—Ä–Ω–∞—è", "–ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∞—è", "–¢–µ–∫—Å—Ç–∏–ª—å—â–∏–∫–∏", "–ü–µ—á–∞—Ç–Ω–∏–∫–∏", "–ö–ª–µ–Ω–æ–≤—ã–π –±—É–ª—å–≤–∞—Ä", "–ö–∞—à–∏—Ä—Å–∫–∞—è", "–í–∞—Ä—à–∞–≤—Å–∫–∞—è", "–ö–∞—Ö–æ–≤—Å–∫–∞—è"],
    "15": ["–ù–∞—Ä–æ–¥–Ω–æ–µ –û–ø–æ–ª—á–µ–Ω–∏–µ", "–ú–Ω—ë–≤–Ω–∏–∫–∏", "–¢–µ—Ä–µ—Ö–æ–≤–æ", "–ö—É–Ω—Ü–µ–≤—Å–∫–∞—è"],
    "D1": ["–ì–µ–Ω–µ—Ä–∞–ª–∞ –ö–∞—Ä–±—ã—à–µ–≤–∞", "–§–∏–ª–∏", "–û—Ñ–∏—Å–Ω–∞—è", "–¢–µ—Å—Ç–æ–≤—Å–∫–∞—è", "–°–∞–≤—ë–ª–æ–≤—Å–∫–∞—è", "–û—Å—Ç–∞–Ω–∫–∏–Ω–æ", "–†–æ—Å—Ç–æ–∫–∏–Ω–æ", "–ë–µ–ª–æ–∫–∞–º–µ–Ω–Ω–∞—è", "–õ–æ—Å–∏–Ω–æ–æ—Å—Ç—Ä–æ–≤—Å–∫–∞—è", "–Ø—Ä–æ—Å–ª–∞–≤—Å–∫–∞—è", "–ú—ã—Ç–∏—â–∏", "–ü–µ—Ä–ª–æ–≤—Å–∫–∞—è", "–¢–∞–π–Ω–∏–Ω—Å–∫–∞—è", "–õ–æ—Å—å", "–ë–∞–±—É—à–∫–∏–Ω—Å–∫–∞—è", "–°–≤–∏–±–ª–æ–≤–æ"],
    "D2": ["–ê–ø—Ä–µ–ª–µ–≤–∫–∞", "–ü–æ–±–µ–¥–∞", "–ö—Ä–µ–∫—à–∏–Ω–æ", "–°–∞–Ω–∏–Ω–æ", "–¢–æ–ª—Å—Ç–æ–ø–∞–ª—å—Ü–µ–≤–æ", "–í–Ω—É–∫–æ–≤–æ", "–ú–∏—á—É—Ä–∏–Ω–µ—Ü", "–ü–µ—Ä–µ–¥–µ–ª–∫–∏–Ω–æ", "–°–æ–ª–Ω–µ—á–Ω–∞—è", "–û—á–∞–∫–æ–≤–æ", "–ú–∞—Ç–≤–µ–µ–≤—Å–∫–∞—è", "–ê–º–∏–Ω—å–µ–≤—Å–∫–∞—è", "–ö—É–Ω—Ü–µ–≤—Å–∫–∞—è", "–°–ª–∞–≤—è–Ω—Å–∫–∏–π –±—É–ª—å–≤–∞—Ä", "–§–∏–ª–∏", "–¢–µ—Å—Ç–æ–≤—Å–∫–∞—è", "–ë–µ–ª–æ—Ä—É—Å—Å–∫–∞—è", "–°–∞–≤—ë–ª–æ–≤—Å–∫–∞—è"],
    "D3": ["–ö—Ä—é–∫–æ–≤–æ", "–§–∏—Ä—Å–∞–Ω–æ–≤—Å–∫–∞—è", "–°—Ö–æ–¥–Ω—è", "–ü–æ–¥—Ä–µ–∑–∫–æ–≤–æ", "–õ–æ–±–Ω—è", "–®–µ—Ä–µ–º–µ—Ç—å–µ–≤—Å–∫–∞—è", "–•–ª–µ–±–Ω–∏–∫–æ–≤–æ", "–î–æ–ª–≥–æ–ø—Ä—É–¥–Ω–∞—è", "–ú–∞—Ä–∫", "–õ–∏–∞–Ω–æ–∑–æ–≤–æ", "–ë–µ—Å–∫—É–¥–Ω–∏–∫–æ–≤–æ", "–û–∫—Ä—É–∂–Ω–∞—è", "–°–∞–≤—ë–ª–æ–≤—Å–∫–∞—è"],
    "D4": ["–ñ–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω–∞—è", "–†–µ—É—Ç–æ–≤", "–ù–æ–≤–æ–≥–∏—Ä–µ–µ–≤–æ", "–ü–µ—Ä–æ–≤–æ", "–ö—É—Å–∫–æ–≤–æ", "–ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∞—è", "–°–µ—Ä–ø –∏ –ú–æ–ª–æ—Ç", "–ö—É—Ä—Å–∫–∞—è", "–ú–æ—Å–∫–≤–∞-–¢–æ–≤–∞—Ä–Ω–∞—è", "–ö–∞–ª–∞–Ω—á—ë–≤—Å–∫–∞—è", "–†–∏–∂—Å–∫–∞—è", "–û—Å—Ç–∞–Ω–∫–∏–Ω–æ", "–†–æ—Å—Ç–æ–∫–∏–Ω–æ", "–ë–µ–ª–æ–∫–∞–º–µ–Ω–Ω–∞—è"]
  };
let currentCategory = "mcd";
  const stations = [];

  function buildStations() {
    stations.length = 0;

    for (const [line, list] of Object.entries(data)) {
      const isMCD = line.startsWith('D');

      if ((currentCategory === "mcd" && isMCD) ||
          (currentCategory === "metro" && !isMCD)) {

        list.forEach(name => {
          stations.push({
            name: `${name} ${isMCD ? ' ¬∑ –õ–∏–Ω–∏—è ' : ''}${line}`,
            icon: `img/${line}.svg`,
            lineId: line
          });
        });
      }
    }
  }

  buildStations();

  const searchInput = document.getElementById('station-search');
  const dropdown = document.getElementById('custom-stations-list');
  let selected = "";

  // –§–£–ù–ö–¶–ò–Ø –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–Ø –í–ö–õ–ê–î–û–ö
  window.switchCategory = function(cat) {
    if (currentCategory === cat) return;
    currentCategory = cat;

    // –î–≤–∏–≥–∞–µ–º –ø–æ–ª–∑—É–Ω–æ–∫
    document.getElementById('tabs-container')
      .classList.toggle('metro-active', cat === 'metro');

    document.getElementById('tab-mcd')
      .classList.toggle('active', cat === 'mcd');

    document.getElementById('tab-metro')
      .classList.toggle('active', cat === 'metro');

    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º UI
    searchInput.value = "";
    selected = "";
    document.documentElement.style.setProperty('--primary-color', '#005AAB');
    dropdown.classList.remove('active');

    buildStations(); // –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å—Ç–∞–Ω—Ü–∏–π
    tg.HapticFeedback.impactOccurred('light');
  };

  function render(val) {
    dropdown.innerHTML = "";

    const filtered = stations
      .filter(s => s.name.toLowerCase().includes(val.toLowerCase()))
      .slice(0, 15);

    if (filtered.length === 0 || val === "") {
      dropdown.classList.remove('active');
      return;
    }

    filtered.forEach(s => {
      const div = document.createElement('div');
      div.className = 'dropdown-item';

      div.innerHTML = `
        <div class="icon-box">
          <img src="${s.icon}" onerror="this.src='img/metro.svg'">
        </div>
        <div class="name">${s.name}</div>
      `;

      div.onclick = () => {
        searchInput.value = s.name;
        selected = s.name;
        dropdown.classList.remove('active');

        const newColor = lineColors[s.lineId] || '#005AAB';
        document.documentElement.style
          .setProperty('--primary-color', newColor);

        tg.HapticFeedback.impactOccurred('light');
      };

      dropdown.appendChild(div);
    });

    dropdown.classList.add('active');
  }

  searchInput.oninput = (e) => render(e.target.value);

  document.onclick = (e) => {
    if (e.target !== searchInput)
      dropdown.classList.remove('active');
  };
document.getElementById('submit-btn').onclick = function() {
    const desc = document.getElementById('description').value.trim();

    if (!desc || !selected) {
      tg.HapticFeedback.notificationOccurred('error');
      tg.showAlert("–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–∞–Ω—Ü–∏—é –∏ –æ–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É");
      return;
    }

    const btn = this;
    btn.classList.add('train-depart');
    tg.HapticFeedback.impactOccurred('heavy');

    const delays = [400, 350, 300, 250, 200, 150, 120, 100, 80, 60, 50, 40, 30, 20, 10, 0];
    let step = 0;

    function clackTrain() {
      if (step < delays.length) {
        let impactType = step % 2 === 0 ? 'rigid' : 'medium';
        tg.HapticFeedback.impactOccurred(impactType);
        setTimeout(clackTrain, delays[step]);
        step++;
      }
    }

    setTimeout(clackTrain, 350);

    setTimeout(() => {
      tg.HapticFeedback.notificationOccurred('success');

      // –û–¢–ü–†–ê–í–õ–Ø–ï–ú –ú–ê–¢–ï–†–ò–ê–õ –ë–û–¢–£, –ß–¢–û–ë–´ –û–ù –ó–ù–ê–õ –ö–£–î–ê –ü–ï–†–ï–°–õ–ê–¢–¨ (mcd –∏–ª–∏ metro)
      tg.sendData(JSON.stringify({
        station: selected,
        description: desc,
        category: currentCategory
      }));

      tg.close();
    }, 3800);
  };
</script>
</body>
</html>
